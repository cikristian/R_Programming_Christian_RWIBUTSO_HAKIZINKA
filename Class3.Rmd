---
title: "Class Three"
author: "Christian Rwibutso Hakizinka"
date: "2025-10-16"
output: html_document
---

### Name: Christian Rwibutso Hakizinka
### StudID: 101373
### --------------------------------------


### Data Visualization and Data management
### Test to treat data

```{r}
data1 <- read.table(text = "
Month Sept_2022 Oct_2022 Nov_2022 Dec_2022 Jan_2023 Feb_2023 Mar_2023 Apr_2023 May_2023 June_2023
Male  4 6 30 140 67 47 23 39 134 80
Female 10 2 29 164 72 81 28 63 211 132
", header = TRUE, row.names = 1)

barplot(as.matrix(data1),
        main = "Confirmed Cases vs Gender",
        beside = TRUE,
        col = c("gold3", "red"))

legend("topright",
       legend = c("Male", "Female"),
       cex = 0.8,
       bty = "n",
       fill = c("gold3", "red"))
```
### Coved test

```{r}
 data3 <- read.table(text="
Month      Male  Female
Sept_2022  867   582
Oct_2022   1802  12003
Nov_2022   3059  9205
Dec_2022   5346  7269
Jan_2023   5933  3245
Feb_2023   842   436
Mar_2023   1805  11785
Apr_2023   3508  10908
May_2023   4902  7883
June_2023  5901  4646
", header = TRUE)
# Barplot: Male vs Female COVID-19 tests
barplot(
  height = t(as.matrix(data3[, 2:3])),   
  beside = TRUE,
  names.arg = data3$Month,
  main = "COVID-19 Tests by Gender",
  col = c("blue", "purple"),
  las = 2,            
  cex.names = 0.8
)

legend("topleft",
       legend = c("Male", "Female"),
       fill = c("blue", "purple"),
       cex = 0.9, bty = "n")
```
### Confirmed case vs age category

```{r}
data2 <- read.table(text="
Month       Less_15  Age_15_49  Above_50
Sept_2022   0        11         3
Oct_2022    0         3         5
Nov_2022    1        41        17
Dec_2022    9       242        53
Jan_2023    8       104        27
Feb_2023    7        78        43
Mar_2023    1        44         6
Apr_2023    4        86        12
May_2023   11       244        90
June_2023  22       147        43
", header = TRUE)

barplot(
  height = t(as.matrix(data2[, 2:4])),   # transpose to group by month
  beside = TRUE,
  names.arg = data2$Month,
  main = "Confirmed COVID-19 Cases by Age Category",
  col = c("green", "blue", "purple"),
  las = 2,           # make month labels vertical for readability
  cex.names = 0.8
)

legend("topleft",
       legend = c("Less than 15 years", "15â€“49 years", "Above 50"),
       fill = c("green", "blue", "purple"),
       cex = 0.9, bty = "n")
```

### Confirmed cases Vs treatment

```{r}
months<-c("Sept_2022","Oct_2022","Nov_2022","Dec_2022", "Jan_2023","Feb
 _2023","Mar_2023","Apr_2023","May_2023","June_2023")
 Confirmed_covid<-c(14,8,59,304,139,128,51,102,345,212)
 plot(Confirmed_covid, type = "l",pch=21, col = "red",ylim=c(0,350),
 xaxt="n", ylab = "Number of patients ",
 main = "Confirmed cases Vs treatment ")
 treatment<- c(12,0,26,217,104,57,12,47,23,20)
 lines(treatment, col="blue",lty=2)
 legend("topleft", legend=c("Received treatment", "Confirmed"),cex=0.5,
 fill = c("blue","red"))
 axis(1,at=1:10,lab=c("Sept_2022","Oct_2022","Nov_2022","Dec_2022", "Jan
 _2023","Feb_2023","Mar_2023","Apr_2023","May_2023","June_2023"))

```

### COVID 19 Test

```{r}
months<-c("sept_2022","Oct_2022","Nov_2022","Dec_2022", "Jan_2023","feb
 _2023","Mar_2023","Apr_2023","May_2023", "June_2023")
 number_of_test<-c(1709, 1018, 3607,23788,6567,20113,10248,15152,11834,
 7891)
 plot(number_of_test, type = "o", col = "blue",ylim=c(0,24000),
 xaxt="n", ylab = "Number of Test",
 main = "COVID 19 Test")
 axis(1,at=1:10,lab=c("Sept_2022","Oct_2022","Nov_2022","Dec_2022", "Jan
 _2023","Feb_2023","Mar_2023","Apr_2023","May_2023","June_2023"))

```

### Library ggplot2

```{r}
 # install.packages("ggplot2")
 library(ggplot2)
# let us explore the data mcars
 data(mtcars)
 #dotchart(mtcars$mpg,labels=row.names(mtcars),ce#x = 0.,main="miles per
 #Gallon of car #model",xlab = "MPG")
 table(mtcars$cyl)
```
```{r}
# barplot(mtcars$cyl)
 barplot(table(mtcars$cyl),main="Distribution of car Cylinder counts",
         xlab="Number of cylinders",ylab = "Number of cars")

```
```{r}
barplot(table(mtcars$cyl),main="Distribution of car Cylinder counts",
      xlab="Number of cylinders",ylab = "Number of cars",horiz=TRUE)

```
 
 
```{r}
plot(mtcars$mpg~mtcars$wt,main="Automobile Data",xlab="Weight",
ylab=" Miles per Gallon")
```

```{r}
plot(mtcars$mpg~mtcars$wt,main="Automobile Data",xlab="Weight",
ylab=" Miles per Gallon")
 plot(mtcars$mpg~mtcars$wt,pch=17,main="Automobile Data",xlab="Weight",
      ylab=" Miles per Gallon")

```

```{r}
plot(mtcars$mpg~mtcars$wt,type="l", lty=2, lwd=2,col="red",main="Automo
 bile Data",xlab="Weight",ylab=" Miles per Gallon")
```

### in ggplot2, plots are created by chaining together function using (+)sign. 
# plot created up to that point

```{r}
 ggplot(data=mtcars, aes(x=wt,y=mpg))+geom_point()+
 labs(title = "Automobile Data",x="Weight",y="Miles per Galon")

```
```{r}
ggplot(data=mtcars, aes(x=wt,y=mpg))+geom_point(pch=17,color="blue",
        size=1)+
 geom_smooth(method="lm",color="green")+
 labs(title = "Automobile Data",x="Weight",y="Miles per Galon")
 #`geom_smooth()` using formula = 'y ~ x'

```

```{r}
f0<-ggplot(data=mtcars, aes(x=wt,y=mpg))+geom_point(shape=24, fill=1,
              size=1)+
 geom_smooth(method="lm",color="blue")
 f0
 # `geom_smooth()` using formula = 'y ~ x'

```
```{r}
f1<-f0+theme_bw()
 f1
f2<-f1+
 theme(panel.grid = element_line(linetype = "dotted",color = "Black"))
 f2
```
### Grouping displays two or more groups of observations in a single plot

```{r}
 mtcars$am<-factor(mtcars$am, levels =c(0,1),
 labels= c("Automatic","Manual"))
 mtcars$vs<-factor(mtcars$vs, levels =c(0,1),
 labels=c("V-Engine","Straight Engine"))
 mtcars$cyl<-factor(mtcars$cyl)
 ggplot(data=mtcars,aes(x=hp,y=mpg,shape=cyl,color=cyl))+
 geom_point(size=3)+
 facet_grid(vs~am)+
 labs(title = "Automobile Data by Engine Type",x="HorsePower",y="Miles
 per Gallon")

```
```{r}
data(singer,package="lattice")
ggplot(singer,aes(x=voice.part,y=height))+geom_boxplot()
```
### Usethefollowingfunction:
### geom_bar()geom_boxplot()geom_density()geom_histogram()geom_hline()
### geom_jitter()geom_line()#geom_point()geom_rug()#geom_smooth()geom_text()
### geom_violin()geom_vline()
### Basicdatamanagement

### cbind and rbind
```{r}
data5<-data.frame(x=1:3,y=c("a","b","c"))
str(data5)
```
```{r}
(cbind(data5,data.frame(z=3:1)))
```
```{r}
(rbind(data5,data.frame(x=10,y="z")))
```
### Create another Variable

```{r}
data_class<-read.table("C:\\Users\\yanga\\Downloads\\class_data.txt", header = TRUE, sep = "\t")
variable.names(data_class)
```

```{r}
head(data_class)

```
```{r}
tail(data_class)
```
```{r}
data_class[,1]
```
 
```{r}
 summary(data_class$WEIGHT)
```
```{r}
length(data_class$WEIGHT)
```
```{r}
data_class[,-1]
```
```{r}
attach(data_class)
 (BMI<-WEIGHT/(HEIGHT/100)^2)
```
```{r}
(BMI<-round(WEIGHT/(HEIGHT/100)^2,digit=1))
```
```{r}
 head(cbind(data_class,BMI))
```
```{r}
 tail(cbind(data_class,BMI),n=10)
```

```{r}
 detach(data_class)
```
###  SummaryofBMI

```{r}
 summary(BMI)
```

```{r}
hist(data_class$HEIGHT)

```
```{r}
hist(data_class$WEIGHT,col = "blue",main = "Sample Histogram")
```

```{r}
stem(BMI,scale=2)
```
### Subsetting

```{r}
 manager<-c(1,2,3,4,5)
 country<-c("US","US","UK","UK","UK")
 gender<-c("M","F","F","M","F")
 age<-c(32,45,25,39,99)
 q1<-c(5,3,3,3,2)
 q2<-c(4,5,5,3,2)
 q3<-c(5,2,5,4,1)
 q4<-c(5,5,5,NA,2)
 q5<-c(5,5,2,NA,1)
 leadership<-data.frame(manager,country,gender,age,q1,q2,q3,q4,q5,
 stringsAsFactors=FALSE)
 leadership<-data.frame(manager,country,gender,age,q1,q2,q3,q4,q5)
 str(leadership)
```

```{r}
 names(leadership)
```
###  Missing value
```{r}
 leadership$age[leadership$age==99]<-NA
 leadership$agecat[leadership$age>75]<-"Elder"
 leadership$agecat[leadership$age>=35&leadership$age<=75]<-"MiddleAged"
 leadership$agecat[leadership$age<35]<-"Young"
```

### One way to handle missing value
```{r}
is.na(leadership[,5:9])
```
```{r}
 newdata<-na.omit(leadership)
 newdata
```
###  Sorting data
```{r}
order(leadership$age)
```
### Merging datasets

###  Subset(selecting variables,dropping variables,selecting observation)
```{r}
 newdata3<-leadership[,c(5:9)]
 myvars<-c("q1","q2","q3","q4","q5")
 newdata3<-leadership[myvars]
 newdata4<-leadership[,c(-1,-2)]
 newdata4<-leadership[,-(1:5)]
 newdata5<-leadership[,c(-1,-7)]
 leadership[[4]]
```
```{r}
leadership$age
```
```{r}
newdata6<-leadership[c(-1,-3),]
 newdata6<-leadership[c(2,4,5),]
 newdata7<-subset(leadership,age>=35|age<24,select=c(q1,q2,q3,q4,q5))
```
```{r}
attach(leadership)
# newdata7 <- leadership[gender="M" & age > 30,]   # incorrect (you fixed this)
newdata7 <- leadership[gender == "M" & age > 30,]  # correct
detach(leadership)
```
### Data management with dyplr
### The function filter()

```{r}
library(nycflights13)

str(flights)
```
```{r}
library(tidyverse)
#attach(flights)
jan<-filter(flights,month==1)
jan
```
```{r}
newyear<-filter(flights,month==1,day==1)
newyear
```


```{r}
 dec25<-filter(flights,month==12,day==25)
 dec25
```
```{r}
jan_dec<-filter(flights,month==1|month==12)
 jan_dec
```
```{r}
 nov_dec<-filter(flights,month%in%c(11,12))
 #detach(flights)
```

### The function arrange()
```{r}
data_10<-arrange(flights,year,month,day)
 arrange(flights,desc(arr_delay))
```
###  The function select
```{r}
 time_var<-select(flights,year,month,day)
 select(flights,year:day)
```
```{r}
 select(flights,-(year:day))
```

### The function mutate
### This is useful in adding a new Variable
```{r}
 ##createasmalldataset
 flights2<-select(flights,year:day,ends_with("delay"),distance,air_time)
 (mutate(flights2,gain=arr_delay-dep_delay,
 speed=distance/air_time*60))
```